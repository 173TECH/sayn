
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://173tech.github.io/sayn/tutorials/tutorial_part2/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Tutorial (Part 2) - SAYN</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#00bdd6">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/admonitions.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-149287493-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="cyan" data-md-color-accent="blue">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-part-2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://173tech.github.io/sayn/" title="SAYN" class="md-header-nav__button md-logo" aria-label="SAYN">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            SAYN
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Tutorial (Part 2)
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/173TECH/sayn" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    173TECH/sayn
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://173tech.github.io/sayn/" title="SAYN" class="md-nav__button md-logo" aria-label="SAYN">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    SAYN
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/173TECH/sayn" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    173TECH/sayn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial_part1/" class="md-nav__link">
      Tutorial (Part 1)
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Tutorial (Part 2)
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Tutorial (Part 2)
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-define-the-project-parameters" class="md-nav__link">
    Step 1: Define the project parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-making-tasks-dynamic-with-parameters" class="md-nav__link">
    Step 2: Making Tasks Dynamic With parameters
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Making Tasks Dynamic With parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-python-tasks" class="md-nav__link">
    In python tasks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-autosql-tasks" class="md-nav__link">
    In autosql tasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-making-task-definitions-dynamic-with-parameters" class="md-nav__link">
    Step 3: Making task definitions dynamic with parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-using-presets-to-standardise-task-definitions" class="md-nav__link">
    Step 4: Using presets to standardise task definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-our-new-project" class="md-nav__link">
    Running Our New Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-next" class="md-nav__link">
    What Next?
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Core concepts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Core concepts" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Core concepts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cli/" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../project_structure/" class="md-nav__link">
      Project Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/project_yaml/" class="md-nav__link">
      project.yaml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/settings_yaml/" class="md-nav__link">
      settings.yaml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/overview/" class="md-nav__link">
      Tasks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../presets/" class="md-nav__link">
      Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../parameters/" class="md-nav__link">
      Parameters
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tasks
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tasks" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Tasks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/autosql/" class="md-nav__link">
      AutoSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/python/" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/sql/" class="md-nav__link">
      SQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/copy/" class="md-nav__link">
      Copy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tasks/dummy/" class="md-nav__link">
      Dummy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Databases
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Databases" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Databases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/bigquery/" class="md-nav__link">
      BigQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/mysql/" class="md-nav__link">
      MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/postgresql/" class="md-nav__link">
      PostgreSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/redshift/" class="md-nav__link">
      Redshift
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/snowflake/" class="md-nav__link">
      Snowflake
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/sqlite/" class="md-nav__link">
      SQLite
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      API Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/database/" class="md-nav__link">
      Database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/python_task/" class="md-nav__link">
      PythonTask
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-define-the-project-parameters" class="md-nav__link">
    Step 1: Define the project parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-making-tasks-dynamic-with-parameters" class="md-nav__link">
    Step 2: Making Tasks Dynamic With parameters
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Making Tasks Dynamic With parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-python-tasks" class="md-nav__link">
    In python tasks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-autosql-tasks" class="md-nav__link">
    In autosql tasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-making-task-definitions-dynamic-with-parameters" class="md-nav__link">
    Step 3: Making task definitions dynamic with parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-using-presets-to-standardise-task-definitions" class="md-nav__link">
    Step 4: Using presets to standardise task definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-our-new-project" class="md-nav__link">
    Running Our New Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-next" class="md-nav__link">
    What Next?
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="tutorial-part-2">Tutorial: Part 2<a class="headerlink" href="#tutorial-part-2" title="Permanent link">&para;</a></h1>
<p>This tutorial builds upon the <a href="../tutorial_part1/">Tutorial: Part 1</a> and introduces you to SAYN concepts which will enable you to make your projects more dynamic and efficient.</p>
<p>In <a href="../tutorial_part1/">Tutorial: Part 1</a> we implemented our first ETL process with SAYN. We will now expand on that by adding <code>parameters</code> and <code>presets</code>.</p>
<p>A <a href="https://github.com/173TECH/sayn_tutorial_part2" target="_blank">Github repository</a> is available with the final code if you prefer to have all the code written directly. After cloning, you simply need to make sure to rename the <code>sample_settings.yaml</code> file to <code>settings.yaml</code> for the project to work.</p>
<h3 id="step-1-define-the-project-parameters">Step 1: Define the project <code>parameters</code><a class="headerlink" href="#step-1-define-the-project-parameters" title="Permanent link">&para;</a></h3>
<p>You can use <code>parameters</code> in order to make your SAYN tasks' code dynamic. We will set one project parameter called <code>user_prefix</code>. This will enable us to distinguish which user generated tables.</p>
<p>First, add <code>paramaters</code> at the end of <code>project.yaml</code>. This is a YAML map which defines the default value.</p>
<div class="admonition example">
<p class="admonition-title">project.yaml</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ...</span>
<span class="nt">parameters</span><span class="p">:</span>
  <span class="nt">user_prefix</span><span class="p">:</span> <span class="s">&#39;&#39;</span> <span class="c1">#no prefix for prod</span>
</code></pre></div>

</div>
<p>In this case we defined a parameter <code>user_prefix</code> that we will use to name tables. This is useful when multiple users are testing a project as it allows the final table name to be different between collaborators.</p>
<p>Now we can define the value of the parameter on each profile. We do this in the <code>settings.yaml</code>.</p>
<div class="admonition example">
<p class="admonition-title">settings.yaml</p>
<div class="highlight"><pre><span></span><code><span class="nt">profiles</span><span class="p">:</span>
  <span class="nt">dev</span><span class="p">:</span>
    <span class="nt">credentials</span><span class="p">:</span>
      <span class="nt">warehouse</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev_db</span>
    <span class="nt">parameters</span><span class="p">:</span>
      <span class="nt">user_prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">up_</span>
  <span class="nt">prod</span><span class="p">:</span>
    <span class="nt">credentials</span><span class="p">:</span>
      <span class="nt">warehouse</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">prod_db</span>
</code></pre></div>

</div>
<p>Note how we don't redefine the parameter in our prod profile as the default value is more appropriate.</p>
<h3 id="step-2-making-tasks-dynamic-with-parameters">Step 2: Making Tasks Dynamic With <code>parameters</code><a class="headerlink" href="#step-2-making-tasks-dynamic-with-parameters" title="Permanent link">&para;</a></h3>
<p>Now that our parameters are setup, we can use those to make our tasks' code dynamic.</p>
<h4 id="in-python-tasks">In <code>python</code> tasks<a class="headerlink" href="#in-python-tasks" title="Permanent link">&para;</a></h4>
<p>For the Python <code>load_data</code> task, we will access the <code>user_prefix</code> parameter and then pass it to the
functions doing the data processing. You can look into <code>python/utils.py</code> to see how we use the <code>user_prefix</code> parameter to change the table names.</p>
<div class="admonition example">
<p class="admonition-title">python/load_data.py</p>
<div class="highlight"><pre><span></span><code>    <span class="c1"># ...</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">user_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;user_prefix&#39;</span><span class="p">]</span>
    <span class="c1"># ...</span>
                <span class="n">q_create</span> <span class="o">=</span> <span class="n">get_create_table</span><span class="p">(</span><span class="n">log_type</span><span class="p">,</span> <span class="n">user_prefix</span><span class="p">)</span>
    <span class="c1"># ...</span>
</code></pre></div>

</div>
<h4 id="in-autosql-tasks">In <code>autosql</code> tasks<a class="headerlink" href="#in-autosql-tasks" title="Permanent link">&para;</a></h4>
<p>The files in the <code>sql</code> folder are always interpreted as <a href="https://palletsprojects.com/p/jinja/" target="_blank">Jinja</a>
templates. This means that in order to access parameters all we have to do is enclose it in <code>{{ }}</code> Jinja blocks. For example, in order to reference the tables created by <code>load_data</code> the <code>dim_arenas</code> task can be changed like this:</p>
<div class="admonition example">
<p class="admonition-title">sql/dim_arenas.sql</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">l</span><span class="p">.</span><span class="n">arena_id</span>
     <span class="p">,</span> <span class="n">l</span><span class="p">.</span><span class="n">arena_name</span>

<span class="k">FROM</span> <span class="err">{{</span><span class="n">user_prefix</span><span class="err">}}</span><span class="n">logs_arenas</span> <span class="n">l</span>
</code></pre></div>

</div>
<p>Now <code>sayn run</code> will transform the above into valid SQL creating <code>compile/base/dim_arenas.sql</code> with it. The file path following the rule <code>compile/task_group_name/autosql_task_name.sql</code>:</p>
<div class="admonition example">
<p class="admonition-title">compile/base/dim_arenas.sql</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">l</span><span class="p">.</span><span class="n">arena_id</span>
     <span class="p">,</span> <span class="n">l</span><span class="p">.</span><span class="n">arena_name</span>

<span class="k">FROM</span> <span class="n">up_logs_arenas</span> <span class="n">l</span>
</code></pre></div>

</div>
<p>SAYN provides a <code>sayn compile</code> command that works like <code>sayn run</code> except that it won't execute the code. What it does though, is generate the compiled files that SAYN would run with the <code>sayn run</code> command.</p>
<h3 id="step-3-making-task-definitions-dynamic-with-parameters">Step 3: Making task definitions dynamic with <code>parameters</code><a class="headerlink" href="#step-3-making-task-definitions-dynamic-with-parameters" title="Permanent link">&para;</a></h3>
<p>Now that our python task generates tables with the <code>user_prefix</code> in the name and our autosql tasks will select data from it. What we also need to do is change the table names our autosql tasks are generating. For that, let's take <code>dim_arenas</code> and modify it so that it generates a table called <code>up_dim_arenas</code> (or other user_prefix defined in <code>settings.yaml</code>):</p>
<div class="admonition example">
<p class="admonition-title">tasks/base.yaml</p>
<div class="highlight"><pre><span></span><code><span class="nt">tasks</span><span class="p">:</span>
  <span class="c1"># ...</span>
  <span class="nt">dim_arenas</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">autosql</span>
    <span class="nt">file_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dim_arenas.sql</span>
    <span class="nt">materialisation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">table</span>
    <span class="nt">destination</span><span class="p">:</span>
      <span class="nt">table</span><span class="p">:</span> <span class="s">&#39;{{</span><span class="nv"> </span><span class="s">user_prefix</span><span class="nv"> </span><span class="s">}}{{</span><span class="nv"> </span><span class="s">task.name</span><span class="nv"> </span><span class="s">}}&#39;</span>
    <span class="nt">parents</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">load_data</span>
  <span class="c1"># ...</span>
</code></pre></div>

</div>
<p>Note the value of <code>destination.table</code> is now some Jinja code that will compile to the value of <code>user_prefix</code> followed by the name of the task.</p>
<h3 id="step-4-using-presets-to-standardise-task-definitions">Step 4: Using <code>presets</code> to standardise task definitions<a class="headerlink" href="#step-4-using-presets-to-standardise-task-definitions" title="Permanent link">&para;</a></h3>
<p>Because most of our tasks have a similar configuration, we can significantly reduce the YAML task definitions using <code>presets</code>. <code>presets</code> allow you to define common properties shared by several
tasks.</p>
<div class="admonition example">
<p class="admonition-title">tasks/base.yaml</p>
<div class="highlight"><pre><span></span><code><span class="nt">presets</span><span class="p">:</span>
  <span class="nt">modelling</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">autosql</span>
    <span class="nt">file_name</span><span class="p">:</span> <span class="s">&#39;{{</span><span class="nv"> </span><span class="s">task.name</span><span class="nv"> </span><span class="s">}}.sql&#39;</span>
    <span class="nt">materialisation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">table</span>
    <span class="nt">destination</span><span class="p">:</span>
      <span class="nt">table</span><span class="p">:</span> <span class="s">&#39;{{</span><span class="nv"> </span><span class="s">user_prefix</span><span class="nv"> </span><span class="s">}}{{</span><span class="nv"> </span><span class="s">task.name</span><span class="nv"> </span><span class="s">}}&#39;</span>
    <span class="nt">parents</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">load_data</span>

<span class="nt">tasks</span><span class="p">:</span>
  <span class="c1"># ...</span>
  <span class="nt">dim_arenas</span><span class="p">:</span>
    <span class="nt">preset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modelling</span>
  <span class="c1"># ...</span>
</code></pre></div>

</div>
<p>Now the <code>modelling</code> preset has to dynamic properties:
* <code>table</code>: defined like we did in the previous so that the create table contains the <code>user_prefix</code> in the name.
* <code>file_name</code>: that uses the task name to point at the correct file in the sql folder.</p>
<p>In addition, <code>modelling</code> is defined so that tasks referencing it:
* are <code>autosql</code> tasks.
* Materialise as tables.
* Have <code>load_data</code> as a parent task, so that models always run after our log generator.</p>
<p>When a task references a preset, we're not restricted to the values defined in the preset. A task can override those values. Take <code>f_rankings</code> for example:</p>
<div class="admonition example">
<p class="admonition-title">tasks/base.yaml</p>
<div class="highlight"><pre><span></span><code><span class="nt">tasks</span><span class="p">:</span>
  <span class="c1"># ...</span>
  <span class="nt">f_rankings</span><span class="p">:</span>
    <span class="nt">preset</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">modelling</span>
    <span class="nt">materialisation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">view</span>
    <span class="nt">parents</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">f_fighter_results</span>
</code></pre></div>

</div>
<p>Here we're overloading 2 properties:
* <code>materialisation</code> which will make f_rankings a view rather than a table.
* <code>parents</code> which will make <code>f_ranking</code> depend on <code>f_fighter_results</code> as well as <code>load_data</code> as defined in the preset.</p>
<h2 id="running-our-new-project">Running Our New Project<a class="headerlink" href="#running-our-new-project" title="Permanent link">&para;</a></h2>
<p>You can now test running <code>sayn run</code> or <code>sayn -p prod</code>. The two options will do the following:</p>
<ul>
<li><code>sayn run</code>:<ul>
<li>use our <code>dev</code> profile</li>
<li>create all tables into a <code>dev.db</code> database</li>
<li>prefix all tables with <code>up_</code> and read from <code>up_</code> prefixed tables</li>
</ul>
</li>
<li><code>sayn run -p prod</code>:<ul>
<li>use our <code>prod</code> profile</li>
<li>create all tables into a <code>prod.db</code> database</li>
<li>will not use a prefix when creating / reading tables</li>
</ul>
</li>
</ul>
<h2 id="what-next">What Next?<a class="headerlink" href="#what-next" title="Permanent link">&para;</a></h2>
<p>This is it, you should now have a good understanding of the core ways of using SAYN. You can play further with this project and easily transfer it to a PostgreSQL database for example by:</p>
<ul>
<li>changing the credentials in <code>settings.yaml</code>.</li>
<li>setting the <code>tmp_schema</code> and <code>schema</code> attributes of your <code>modelling</code> preset to <code>public</code>.</li>
</ul>
<p>Otherwise, you can learn more about the specific SAYN features by having a look at the specific sections of the documentation.</p>
<p>Enjoy SAYN :)</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../tutorial_part1/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Tutorial (Part 1)
              </div>
            </div>
          </a>
        
        
          <a href="../../cli/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                CLI
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/173TECH" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>