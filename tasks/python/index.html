
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://173tech.github.io/sayn/tasks/python/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-6.2.8">
    
    
      
        <title>Python - SAYN</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#00bdd6">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/admonitions.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-149287493-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="cyan" data-md-color-accent="blue">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python_task" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://173tech.github.io/sayn/" title="SAYN" class="md-header-nav__button md-logo" aria-label="SAYN">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            SAYN
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Python
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/173TECH/sayn" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    173TECH/sayn
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://173tech.github.io/sayn/" title="SAYN" class="md-nav__button md-logo" aria-label="SAYN">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    SAYN
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/173TECH/sayn" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    173TECH/sayn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial_part1/" class="md-nav__link">
        Tutorial (Part 1)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial_part2/" class="md-nav__link">
        Tutorial (Part 2)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/tutorial_part3/" class="md-nav__link">
        Tutorial (Part 3)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Core Concepts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Core Concepts" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Core Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../project_structure/" class="md-nav__link">
        Project Structure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/project_yaml/" class="md-nav__link">
        project.yaml
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/settings_yaml/" class="md-nav__link">
        settings.yaml
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Tasks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../presets/" class="md-nav__link">
        Presets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../parameters/" class="md-nav__link">
        Parameters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../database_objects/" class="md-nav__link">
        Database objects
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
      
      <label class="md-nav__link" for="nav-4">
        Tasks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tasks" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Tasks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../autosql/" class="md-nav__link">
        AutoSQL[SUNSETTED]
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Python
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about" class="md-nav__link">
    About
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple_definition_of_python_tasks" class="md-nav__link">
    Simple Definition of python Tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced_python_task_definition_with_classes" class="md-nav__link">
    Advanced python Task Definition With Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using_the_sayn_api" class="md-nav__link">
    Using the SAYN API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging_for_python_tasks_with_the_sayn_api" class="md-nav__link">
    Logging For python Tasks With The SAYN API
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sql/" class="md-nav__link">
        SQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../copy/" class="md-nav__link">
        Copy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dummy/" class="md-nav__link">
        Dummy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
      
      <label class="md-nav__link" for="nav-5">
        Data Tests
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Tests" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Data Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/standard/" class="md-nav__link">
        Standard
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/custom/" class="md-nav__link">
        Custom
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        Databases
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Databases" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Databases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/bigquery/" class="md-nav__link">
        BigQuery
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mysql/" class="md-nav__link">
        MySQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/postgresql/" class="md-nav__link">
        PostgreSQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/redshift/" class="md-nav__link">
        Redshift
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/snowflake/" class="md-nav__link">
        Snowflake
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/sqlite/" class="md-nav__link">
        SQLite
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api/database/" class="md-nav__link">
        Database
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api/python_task/" class="md-nav__link">
        PythonTask
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" >
      
      <label class="md-nav__link" for="nav-8">
        Project Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Project Examples" data-md-level="1">
        <label class="md-nav__title" for="nav-8">
          <span class="md-nav__icon md-icon"></span>
          Project Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../project_examples/simple_etl/" class="md-nav__link">
        A Simple ETL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../project_examples/reddit_news_nlp/" class="md-nav__link">
        Reddit News NLP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../project_examples/facebook_data_project/" class="md-nav__link">
        Facebook Data Project
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about" class="md-nav__link">
    About
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple_definition_of_python_tasks" class="md-nav__link">
    Simple Definition of python Tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced_python_task_definition_with_classes" class="md-nav__link">
    Advanced python Task Definition With Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using_the_sayn_api" class="md-nav__link">
    Using the SAYN API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging_for_python_tasks_with_the_sayn_api" class="md-nav__link">
    Logging For python Tasks With The SAYN API
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="python_task"><code>python</code> Task<a class="headerlink" href="#python_task" title="Permanent link">&para;</a></h1>
<h2 id="about">About<a class="headerlink" href="#about" title="Permanent link">&para;</a></h2>
<p>The <code>python</code> task allows you to run python scripts. Therefore, those tasks can do anything Python can
do. They are extremely useful for data extraction or data science models.</p>
<p>There are two models for specifying python tasks in SAYN: a simple way through using decorators and a more advanced way which is class based.</p>
<h2 id="simple_definition_of_python_tasks">Simple Definition of <code>python</code> Tasks<a class="headerlink" href="#simple_definition_of_python_tasks" title="Permanent link">&para;</a></h2>
<p>You can define <code>python</code> tasks in SAYN very simply by using decorators. This will let you write a Python function and turn that function into a task. First, you need to add a group in <code>project.yaml</code> pointing to the <code>.py</code> file where the task code lives:</p>
<div class="admonition example">
<p class="admonition-title">project.yaml</p>
<div class="highlight"><pre><span></span><code>groups:
  decorator_tasks:
    type: python
    module: decorator_tasks
    parameters:
      param1: some_value
</code></pre></div>
</div>
<p>Now all tasks defined in <code>python/decorator_tasks.py</code> will be added to the DAG. The <code>module</code> property expects a python path from the <code>python</code> folder in a similar way as you would import a module in python. For example, if our task definition exists in <code>python/example_mod/decorator_tasks.py</code> the value in <code>module</code> would be <code>example_mod.decorator_tasks</code>.</p>
<div class="admonition example">
<p class="admonition-title">python/decorator_tasks.py</p>
<div class="highlight"><pre><span></span><code>from sayn import task

@task(outputs=&#39;logs.api_table&#39;, sources=&#39;logs.another_table&#39;)
def example_task(context, warehouse, param1):
    src_table = context.src(&#39;logs.another_table&#39;)
    out_table = context.out(&#39;logs.api_table&#39;)
    warehouse.execute(f&#39;CREATE OR REPLACE TABLE {out_table} AS SELECT * from {src_table}&#39;)
</code></pre></div>
</div>
<p>The above example showcases the key elements to a python task:</p>
<ul>
<li><code>task</code>: we import SAYN's <code>task</code> decorator which is used to turn functions into SAYN tasks added to the DAG.</li>
<li>parameters to <code>task</code>: we can pass parameters <code>sources</code>, <code>outputs</code> and <code>parents</code> which are either lists of table names or a single table name. This allows SAYN define the task dependencies. We can also pass a value for <code>on_fail</code> and <code>tags</code>.</li>
<li>function name: the name of the function (<code>example_task</code> here) will be the name of the task. We can use this name with <code>-t</code> to execute this task only for example.</li>
<li>function parameters: arguments to the function have special meaning and so the names need to be respected:<ul>
<li><code>context</code>: is an object granting access to some functionality like project parameters, connections and other functions as seen further down.</li>
<li><code>warehouse</code>: connection names (<code>required_credentials</code> in <code>project.yaml</code>) will automatically provide the object of that connection. You can specify any number of connections here.</li>
<li>param1: the rest of the function arguments are matched against task parameters, these are values defined in the <code>parameter</code> property in the group.</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Python decorators</p>
<p>Decorators in python are used to modify the behaviour of a function. It can be a bit daunting to understand when we first encounter them but for the purpose of SAYN all you need to know is that <code>@task</code> turns a standard python
function into a SAYN task which can assess useful properties via arguments. There are many resources online describing how decorators work,
<a href="https://realpython.com/primer-on-python-decorators/">for example this</a>.</p>
</div>
<p>Given the code above, this task will:</p>
<ul>
<li>Depend on (execute after) the tasks that produce <code>logs.another_table</code> since we added the <code>sources</code> argument to the decorator.</li>
<li>Be the parent of (execute before) any task reading from <code>logs.api_table</code> since we added the <code>outputs</code> argument to the decorator.</li>
<li>Get the compiled value of <code>logs.another_table</code> and <code>logs.api_table</code> and keep in 2 variables. For details on database objects compilation
    make sure you check <a href="../../database_objects/">the database objects page</a>.</li>
<li>Execute a create table statement using the tables above on the database called <code>warehouse</code> in the project.</li>
</ul>
<h2 id="advanced_python_task_definition_with_classes">Advanced <code>python</code> Task Definition With Classes<a class="headerlink" href="#advanced_python_task_definition_with_classes" title="Permanent link">&para;</a></h2>
<p>The second model for defining python tasks is through classes. When using this model we get an opportunity to:</p>
<ul>
<li>do validation before the task is executed by overloading the <code>setup</code> method, which is useful as a way to alert early during the execution that something is incorrectly defined rather than waiting for the task to fail.</li>
<li>define more complex dependencies than <code>sources</code> and <code>outputs</code> by overloading the <code>config</code> method.</li>
<li>implement code for the <code>compile</code> stage allowing for more early stage indication of problems.</li>
</ul>
<p>A <code>python</code> task using classes is defined as follows:</p>
<div class="admonition example">
<p class="admonition-title">tasks/base.yaml</p>
<div class="highlight"><pre><span></span><code><span class="nt">task_python</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span><span class="w"></span>
<span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file_name.ClassName</span><span class="w"></span>
</code></pre></div>
</div>
<p>Where <code>class</code> is a python path to the Python class implementing the task. This code should be stored in the <code>python</code> folder of your project, which in itself is a python module that's dynamically loaded, so it needs an empty <code>__init__.py</code> file in the folder. The class then needs to be defined as follows:</p>
<div class="admonition example">
<p class="admonition-title">python/file_name.py</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sayn</span> <span class="kn">import</span> <span class="n">PythonTask</span>

<span class="k">class</span> <span class="nc">ClassName</span><span class="p">(</span><span class="n">PythonTask</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">(</span><span class="s1">&#39;logs.source_table&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">(</span><span class="s1">&#39;logs.output_table&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Do some validation of the parameters</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Do something useful</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">()</span>
</code></pre></div>
</div>
<p>In this example:</p>
<ul>
<li>We create a new class inheriting from SAYN's PythonTask.</li>
<li>We set some dependencies by calling <code>self.src</code> and <code>self.out</code>.</li>
<li>We define a setup method to do some sanity checks. This method can be skipped, but it's
  useful to check the validity of project parameters or so some initial setup.</li>
<li>We define the actual process to execute during <code>sayn run</code> with the <code>run</code> method.</li>
<li>Both <code>setup</code> and <code>run</code> return the task status as successful <code>return self.success()</code>, however we can indicate a task failure to sayn with <code>return self.fail()</code>. Failing a python task forces child tasks to be skipped.</li>
</ul>
<details class="attention" open="open">
<summary>Attention</summary>
<p>Python tasks can return <code>self.success()</code> or <code>self.fail()</code> to indicate the result of the execution, but it's not mandatory. If the code throws a python exception, the task will be considered as failed.</p>
</details>
<h2 id="using_the_sayn_api">Using the SAYN API<a class="headerlink" href="#using_the_sayn_api" title="Permanent link">&para;</a></h2>
<p>When defining our <code>python</code> task, you would want to access parts of the SAYN infrastructure like
parameters and connections. When using the decorator model, to access this functionality we need to include the <code>context</code> argument in the function, when using the class model the more standard <code>self</code> is used, and both give access to the same functionality. The list of available properties through <code>self</code> and <code>context</code> is:</p>
<ul>
<li><code>parameters</code>: accesses project and task parameters. For more details on <code>parameters</code>,
  see the <a href="../../parameters/">Parameters</a> section.</li>
<li><code>run_arguments</code>: provides access to the arguments passed to the <code>sayn run</code> command like the incremental values (<code>full_load</code>, <code>start_dt</code> and <code>end_dt</code>).</li>
<li><code>connections</code>: dictionary containing the databases and other custom API credentials. API connections appear as simple python dictionaries, while databases are SAYN's <a href="../../api/database/">Database</a> objects.</li>
<li><code>default_db</code>: provides access to the <code>default_db</code> database object specified in the <code>project.yaml</code> file.</li>
<li><code>src</code>: the <code>src</code> macro that translates database object names as described in <a href="../../database_objects/">database objects</a>. Bear in mind that using this function also adds dependencies to the task, but only when called from the <code>config</code> method of a python task defined with the class model.</li>
<li><code>out</code>: the <code>out</code> macro that translates database object names as described in <a href="../../database_objects/">database objects</a>. Bear in mind that using this function also creates dependencies between tasks, but only when called from the <code>config</code> method of a python task defined with the class model.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can use <code>self.default_db</code> to easily perform some operations on the default database such as reading or
loading data or if using decorators simply include an argument with the name of the connection. See the
methods available on the <a href="../../api/database/">Database</a> API.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We all love <code>pandas</code>! If you want to load a pandas dataframe you can use one of these options:</p>
<ul>
<li>with the <code>pandas.DataFrame.to_sql</code> method: <code>df.to_sql(self.default_db.engine, 'table')</code>.</li>
<li>with the <code>self.default_db.load_data</code> method: <code>self.default_db.load_data('table', df.to_dict('records'))</code>.</li>
</ul>
</div>
<h2 id="logging_for_python_tasks_with_the_sayn_api">Logging For <code>python</code> Tasks With The SAYN API<a class="headerlink" href="#logging_for_python_tasks_with_the_sayn_api" title="Permanent link">&para;</a></h2>
<p>The unit of process within a task in SAYN is the <code>step</code>. Using steps is useful to indicate current
progress of execution but also for debugging purposes. The <a href="../../tutorials/tutorial_part3/">tutorial</a> is a good example of usage, as we define the <code>load_data</code> task as having 5 steps:</p>
<div class="admonition example">
<p class="admonition-title">python/load_data.py</p>
<div class="highlight"><pre><span></span><code>   <span class="n">context</span><span class="o">.</span><span class="n">set_run_steps</span><span class="p">(</span>
       <span class="p">[</span>
           <span class="s2">&quot;Generate Data&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Load fighters&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Load arenas&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Load tournaments&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Load battles&quot;</span><span class="p">,</span>
       <span class="p">]</span>
   <span class="p">)</span>
</code></pre></div>
</div>
<p>This code defines which steps form the task. Then we can define the start and end
of that step with:</p>
<div class="admonition example">
<p class="admonition-title">python/load_data.py</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="s1">&#39;Generate Data&#39;</span><span class="p">):</span>
    <span class="n">data_to_load</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">tournament_battles</span><span class="p">)</span>
</code></pre></div>
</div>
<p>Which will output the following on the screen:</p>
<div class="admonition example">
<p class="admonition-title">CLI output</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="m">1</span>/7<span class="o">]</span> load_data <span class="o">(</span>started at <span class="m">15</span>:25<span class="o">)</span>: Step <span class="o">[</span><span class="m">1</span>/5<span class="o">]</span> Generate Data
</code></pre></div>
</div>
<p>The default cli presentation will show only the current step being executed, which in the
case of the tutorial project goes very quickly. However we can persist these messages using
the debug flag to the cli <code>sayn run -d</code> giving you this:</p>
<div class="admonition example">
<p class="admonition-title">CLI ouput</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="m">1</span>/7<span class="o">]</span> load_data <span class="o">(</span>started at <span class="m">15</span>:29<span class="o">)</span>
  Run Steps: Generate Data, Load fighters, Load arenas, Load tournaments, Load battles
  ℹ <span class="o">[</span><span class="m">1</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Executing Generate Data
  ✔ <span class="o">[</span><span class="m">1</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Generate Data <span class="o">(</span><span class="m">19</span>.5ms<span class="o">)</span>
  ℹ <span class="o">[</span><span class="m">2</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Executing Load fighters
  ✔ <span class="o">[</span><span class="m">2</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Load fighters <span class="o">(</span><span class="m">16</span>.9ms<span class="o">)</span>
  ℹ <span class="o">[</span><span class="m">3</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Executing Load arenas
  ✔ <span class="o">[</span><span class="m">3</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Load arenas <span class="o">(</span><span class="m">12</span>.3ms<span class="o">)</span>
  ℹ <span class="o">[</span><span class="m">4</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Executing Load tournaments
  ✔ <span class="o">[</span><span class="m">4</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Load tournaments <span class="o">(</span><span class="m">10</span>.9ms<span class="o">)</span>
  ℹ <span class="o">[</span><span class="m">5</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Executing Load battles
  ✔ <span class="o">[</span><span class="m">5</span>/5<span class="o">]</span> <span class="o">[</span><span class="m">15</span>:29<span class="o">]</span> Load battles <span class="o">(</span><span class="m">210</span>.3ms<span class="o">)</span>
✔ Took <span class="o">(</span>273ms<span class="o">)</span>
</code></pre></div>
</div>
<p>So you can see the time it takes to perform each step.</p>
<p>Sometimes it's useful to output some extra text beyond steps. In those cases, the API provides
some methods for a more adhoc logging model:</p>
<ul>
<li><code>self.debug(text)</code>: debug log to console and file. Not printed unless <code>-d</code> is used.</li>
<li><code>self.info(text)</code>: info log to console and file. Not persisted to the screen if <code>-d</code> is not specified.</li>
<li><code>self.warning(text)</code>: warning log to console and file. Remains on the screen after the task finishes (look for yellow lines).</li>
<li><code>self.error(text)</code>: error log to console and file. Remains on the screen after the task finishes (look for red lines).</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>self.error</code> doesn't abort the execution of the task, nor it sets the final status to being failed.
To indicate a python task has failed, use this construct: <code>return self.fail(text)</code> where text
is an optional message string that will be showed on the screen.</p>
</div>
<p>For more details on the SAYN API, check the <a href="../../api/python_task/">API reference page</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../autosql/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                AutoSQL[SUNSETTED]
              </div>
            </div>
          </a>
        
        
          <a href="../sql/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                SQL
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/173TECH" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>